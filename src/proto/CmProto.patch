*** CmProto.ts	2022-07-14 21:18:07.000000000 -0700
--- CmProto-patched.ts	2022-07-14 21:17:28.000000000 -0700
***************
*** 2,9 ****
   * Generated by the protoc-gen-ts.  DO NOT EDIT!
   * compiler version: 3.15.8
   * source: src/proto/CmProto.proto
   * git: https://github.com/thesayyn/protoc-gen-ts */
! import * as dependency_1 from "./../../node_modules/@thegraid/wspbclient/lib/proto/GgProto";
  import * as pb_1 from "google-protobuf";
  export enum CmType {
      cm_none = 0,
--- 2,10 ----
   * Generated by the protoc-gen-ts.  DO NOT EDIT!
   * compiler version: 3.15.8
   * source: src/proto/CmProto.proto
+  * Patch import "@package" & KVPair constructor
   * git: https://github.com/thesayyn/protoc-gen-ts */
! import * as dependency_1 from "@thegraid/wspbclient";
  import * as pb_1 from "google-protobuf";
  export enum CmType {
      cm_none = 0,
*************** export class TypedMsg extends pb_1.Messa
*** 209,225 ****
      get has_strValue() {
          return pb_1.Message.getField(this, 5) != null;
      }
!     get value() {
          const cases: {
!             [index: number]: "none" | "boolValue" | "intValue" | "strValue";
          } = {
!             0: "none",
              3: "boolValue",
              4: "intValue",
              5: "strValue"
          };
          return cases[pb_1.Message.computeOneofCase(this, [3, 4, 5])];
      }
      static fromObject(data: {
          boolValue?: boolean;
          intValue?: number;
--- 210,229 ----
      get has_strValue() {
          return pb_1.Message.getField(this, 5) != null;
      }
!     get whichValue() {
          const cases: {
!             [index: number]: undefined | "boolValue" | "intValue" | "strValue";
          } = {
!             0: undefined,
              3: "boolValue",
              4: "intValue",
              5: "strValue"
          };
          return cases[pb_1.Message.computeOneofCase(this, [3, 4, 5])];
      }
+     get value(): boolean | number | string {
+         return this[this.whichValue]
+     }
      static fromObject(data: {
          boolValue?: boolean;
          intValue?: number;
*************** export class KVpair extends pb_1.Message
*** 298,304 ****
      #one_of_decls: number[][] = [];
      constructor(data?: any[] | {
          name?: string;
!         value?: TypedMsg;
      }) {
          super();
          pb_1.Message.initialize(this, Array.isArray(data) ? data : [], 0, -1, [], this.#one_of_decls);
--- 302,308 ----
      #one_of_decls: number[][] = [];
      constructor(data?: any[] | {
          name?: string;
!         value?: TypedMsg | number | string | boolean;  // Hack to allow inner value in constructor
      }) {
          super();
          pb_1.Message.initialize(this, Array.isArray(data) ? data : [], 0, -1, [], this.#one_of_decls);
*************** export class KVpair extends pb_1.Message
*** 307,313 ****
                  this.name = data.name;
              }
              if ("value" in data && data.value != undefined) {
!                 this.value = data.value;
              }
          }
      }
--- 311,322 ----
                  this.name = data.name;
              }
              if ("value" in data && data.value != undefined) {
!                 // Hack the constructor to accept value as TypedMsg.value:
!                 let value = data.value
!                 if (typeof (value) === 'number') value = new TypedMsg({ intValue: value })
!                 if (typeof (value) === 'string') value = new TypedMsg({ strValue: value })
!                 if (typeof (value) === 'boolean') value = new TypedMsg({ boolValue: value })
!                 this.value = value;
              }
          }
      }
*************** export class KVpair extends pb_1.Message
*** 389,394 ****
--- 398,417 ----
  }
  export class CmMsgBase extends pb_1.Message {
      #one_of_decls: number[][] = [];
+ 
+     get has_type() { return pb_1.Message.getField(this, cmField.cmField_type) }
+     get has_client() { return pb_1.Message.getField(this, cmField.cmField_client) }
+     get has_player() { return pb_1.Message.getField(this, cmField.cmField_player) }
+     get has_name() { return pb_1.Message.getField(this, cmField.cmField_name) }
+     get has_json() { return pb_1.Message.getField(this, cmField.cmField_json) }
+     //get has_srcSlot() { return pb_1.Message.getField(this, cmField.cmField_srcSlot) }
+     //get has_dstSlot() { return pb_1.Message.getField(this, cmField.cmField_dstSlot) }
+     get has_inform() { return pb_1.Message.getField(this, cmField.cmField_inform) }
+     get has_count() { return pb_1.Message.getField(this, cmField.cmField_count) }
+     get has_client_to() { return pb_1.Message.getField(this, cmField.cmField_client_to) }
+     get has_roster() { return this.roster?.length > 0 }
+     get has_params() { return pb_1.Message.getField(this, cmField.cmField_params) }
+ 
      constructor(data?: any[] | {
          type?: CmType;
          client?: number;
*************** export class CmMsgBase extends pb_1.Mess
*** 399,410 ****
          inform?: string;
          dstSlot?: CmSlot;
          count?: number;
-         client_to?: number;
          roster?: dependency_1.Rost[];
          params?: KVpair[];
      }) {
          super();
!         pb_1.Message.initialize(this, Array.isArray(data) ? data : [], 0, -1, [11, 12], this.#one_of_decls);
          if (!Array.isArray(data) && typeof data == "object") {
              if ("type" in data && data.type != undefined) {
                  this.type = data.type;
--- 422,433 ----
          inform?: string;
          dstSlot?: CmSlot;
          count?: number;
          roster?: dependency_1.Rost[];
+         client_to?: number;
          params?: KVpair[];
      }) {
          super();
!         pb_1.Message.initialize(this, Array.isArray(data) ? data : [], 0, -1, [10, 12], this.#one_of_decls);
          if (!Array.isArray(data) && typeof data == "object") {
              if ("type" in data && data.type != undefined) {
                  this.type = data.type;
*************** export class CmMsgBase extends pb_1.Mess
*** 433,444 ****
              if ("count" in data && data.count != undefined) {
                  this.count = data.count;
              }
-             if ("client_to" in data && data.client_to != undefined) {
-                 this.client_to = data.client_to;
-             }
              if ("roster" in data && data.roster != undefined) {
                  this.roster = data.roster;
              }
              if ("params" in data && data.params != undefined) {
                  this.params = data.params;
              }
--- 456,467 ----
              if ("count" in data && data.count != undefined) {
                  this.count = data.count;
              }
              if ("roster" in data && data.roster != undefined) {
                  this.roster = data.roster;
              }
+             if ("client_to" in data && data.client_to != undefined) {
+                 this.client_to = data.client_to;
+             }
              if ("params" in data && data.params != undefined) {
                  this.params = data.params;
              }
*************** export class CmMsgBase extends pb_1.Mess
*** 504,520 ****
      set count(value: number) {
          pb_1.Message.setField(this, 9, value);
      }
-     get client_to() {
-         return pb_1.Message.getFieldWithDefault(this, 10, 0) as number;
-     }
-     set client_to(value: number) {
-         pb_1.Message.setField(this, 10, value);
-     }
      get roster() {
!         return pb_1.Message.getRepeatedWrapperField(this, dependency_1.Rost, 11) as dependency_1.Rost[];
      }
      set roster(value: dependency_1.Rost[]) {
!         pb_1.Message.setRepeatedWrapperField(this, 11, value);
      }
      get params() {
          return pb_1.Message.getRepeatedWrapperField(this, KVpair, 12) as KVpair[];
--- 527,543 ----
      set count(value: number) {
          pb_1.Message.setField(this, 9, value);
      }
      get roster() {
!         return pb_1.Message.getRepeatedWrapperField(this, dependency_1.Rost, 10) as dependency_1.Rost[];
      }
      set roster(value: dependency_1.Rost[]) {
!         pb_1.Message.setRepeatedWrapperField(this, 10, value);
!     }
!     get client_to() {
!         return pb_1.Message.getFieldWithDefault(this, 11, 0) as number;
!     }
!     set client_to(value: number) {
!         pb_1.Message.setField(this, 11, value);
      }
      get params() {
          return pb_1.Message.getRepeatedWrapperField(this, KVpair, 12) as KVpair[];
*************** export class CmMsgBase extends pb_1.Mess
*** 532,539 ****
          inform?: string;
          dstSlot?: ReturnType<typeof CmSlot.prototype.toObject>;
          count?: number;
-         client_to?: number;
          roster?: ReturnType<typeof dependency_1.Rost.prototype.toObject>[];
          params?: ReturnType<typeof KVpair.prototype.toObject>[];
      }): CmMsgBase {
          const message = new CmMsgBase({});
--- 555,562 ----
          inform?: string;
          dstSlot?: ReturnType<typeof CmSlot.prototype.toObject>;
          count?: number;
          roster?: ReturnType<typeof dependency_1.Rost.prototype.toObject>[];
+         client_to?: number;
          params?: ReturnType<typeof KVpair.prototype.toObject>[];
      }): CmMsgBase {
          const message = new CmMsgBase({});
*************** export class CmMsgBase extends pb_1.Mess
*** 564,575 ****
          if (data.count != null) {
              message.count = data.count;
          }
-         if (data.client_to != null) {
-             message.client_to = data.client_to;
-         }
          if (data.roster != null) {
              message.roster = data.roster.map(item => dependency_1.Rost.fromObject(item));
          }
          if (data.params != null) {
              message.params = data.params.map(item => KVpair.fromObject(item));
          }
--- 587,598 ----
          if (data.count != null) {
              message.count = data.count;
          }
          if (data.roster != null) {
              message.roster = data.roster.map(item => dependency_1.Rost.fromObject(item));
          }
+         if (data.client_to != null) {
+             message.client_to = data.client_to;
+         }
          if (data.params != null) {
              message.params = data.params.map(item => KVpair.fromObject(item));
          }
*************** export class CmMsgBase extends pb_1.Mess
*** 586,593 ****
              inform?: string;
              dstSlot?: ReturnType<typeof CmSlot.prototype.toObject>;
              count?: number;
-             client_to?: number;
              roster?: ReturnType<typeof dependency_1.Rost.prototype.toObject>[];
              params?: ReturnType<typeof KVpair.prototype.toObject>[];
          } = {};
          if (this.type != null) {
--- 609,616 ----
              inform?: string;
              dstSlot?: ReturnType<typeof CmSlot.prototype.toObject>;
              count?: number;
              roster?: ReturnType<typeof dependency_1.Rost.prototype.toObject>[];
+             client_to?: number;
              params?: ReturnType<typeof KVpair.prototype.toObject>[];
          } = {};
          if (this.type != null) {
*************** export class CmMsgBase extends pb_1.Mess
*** 617,628 ****
          if (this.count != null) {
              data.count = this.count;
          }
-         if (this.client_to != null) {
-             data.client_to = this.client_to;
-         }
          if (this.roster != null) {
              data.roster = this.roster.map((item: dependency_1.Rost) => item.toObject());
          }
          if (this.params != null) {
              data.params = this.params.map((item: KVpair) => item.toObject());
          }
--- 640,651 ----
          if (this.count != null) {
              data.count = this.count;
          }
          if (this.roster != null) {
              data.roster = this.roster.map((item: dependency_1.Rost) => item.toObject());
          }
+         if (this.client_to != null) {
+             data.client_to = this.client_to;
+         }
          if (this.params != null) {
              data.params = this.params.map((item: KVpair) => item.toObject());
          }
*************** export class CmMsgBase extends pb_1.Mess
*** 650,659 ****
              writer.writeMessage(8, this.dstSlot, () => this.dstSlot.serialize(writer));
          if (this.count != 0)
              writer.writeInt32(9, this.count);
-         if (this.client_to != 0)
-             writer.writeInt32(10, this.client_to);
          if (this.roster.length)
!             writer.writeRepeatedMessage(11, this.roster, (item: dependency_1.Rost) => item.serialize(writer));
          if (this.params.length)
              writer.writeRepeatedMessage(12, this.params, (item: KVpair) => item.serialize(writer));
          if (!w)
--- 673,682 ----
              writer.writeMessage(8, this.dstSlot, () => this.dstSlot.serialize(writer));
          if (this.count != 0)
              writer.writeInt32(9, this.count);
          if (this.roster.length)
!             writer.writeRepeatedMessage(10, this.roster, (item: dependency_1.Rost) => item.serialize(writer));
!         if (this.client_to != 0)
!             writer.writeInt32(11, this.client_to);
          if (this.params.length)
              writer.writeRepeatedMessage(12, this.params, (item: KVpair) => item.serialize(writer));
          if (!w)
*************** export class CmMsgBase extends pb_1.Mess
*** 693,702 ****
                      message.count = reader.readInt32();
                      break;
                  case 10:
!                     message.client_to = reader.readInt32();
                      break;
                  case 11:
!                     reader.readMessage(message.roster, () => pb_1.Message.addToRepeatedWrapperField(message, 11, dependency_1.Rost.deserialize(reader), dependency_1.Rost));
                      break;
                  case 12:
                      reader.readMessage(message.params, () => pb_1.Message.addToRepeatedWrapperField(message, 12, KVpair.deserialize(reader), KVpair));
--- 716,725 ----
                      message.count = reader.readInt32();
                      break;
                  case 10:
!                     reader.readMessage(message.roster, () => pb_1.Message.addToRepeatedWrapperField(message, 10, dependency_1.Rost.deserialize(reader), dependency_1.Rost));
                      break;
                  case 11:
!                     message.client_to = reader.readInt32();
                      break;
                  case 12:
                      reader.readMessage(message.params, () => pb_1.Message.addToRepeatedWrapperField(message, 12, KVpair.deserialize(reader), KVpair));
